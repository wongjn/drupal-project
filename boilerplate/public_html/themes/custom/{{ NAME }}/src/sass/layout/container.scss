/**
 * @file
 * Site width container.
 *
 * Lots of Edge-only hacks due to it not being able to properly parse CSS
 * variables with nested calc()s.
 */

@use '../lib/hacks';
@use '../lib/layout';
@use '../lib/viewport';

$fallback-gutter: 20px;

// Site width container.
//
// 1. Add additional gutter width either side to compensate for padding.
.l-container {
  @include viewport.scale(--container-space-x, 40px, 20px);
  margin-right: auto;
  margin-left: auto;
  max-width: (layout.$SITE-WIDTH-PX + ($fallback-gutter * 2)); // 1
  max-width: calc(#{layout.$SITE-WIDTH-PX} + (var(--container-space-x) * 2)); // 1
  --container-space-y: 40px;

  // Edge 17 does not support CSS variables in calc() that use calc()
  // themselves.
  @include hacks.edge(17) {
    max-width: (layout.$SITE-WIDTH-PX + ($fallback-gutter * 2)); // 1
  }

  &,
  &__module {
    padding: ($fallback-gutter / 2);
    padding: calc(var(--container-space-y) / 2) calc(var(--container-space-x) / 2);

    @include hacks.edge {
      padding: ($fallback-gutter / 2);
    }
  }

  // Merges padding and module into the top level element, such that no __module
  // sub-components are required.
  &--module {
    padding: $fallback-gutter;
    padding: var(--container-space-y) var(--container-space-x);

    // Edge 17 does not support CSS variables in calc() that use calc()
    // themselves.
    @include hacks.edge(17) {
      padding: $fallback-gutter;
    }

    .l-container__module {
      padding: 0;
    }
  }
}
